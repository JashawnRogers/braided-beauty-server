<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en"
      th:replace="email/_layout :: layout(~{::content})">

<div th:fragment="content">

  <h3 th:if="${noDepositRequired}" style="margin:0 0 12px 0; font-size:18px;">Appointment confirmed!</h3>
  <h3 th:unless="${noDepositRequired}" style="margin:0 0 12px 0; font-size:18px;">Deposit received!</h3>

  <p style="margin:0 0 12px 0;">
    Hi <strong th:text="${customerName}">Customer</strong>,
  </p>

  <p style="margin:0 0 16px 0;">
    We received your deposit for your appointment on
    <strong th:text="${#temporals.format(appointmentDateTime, 'MMM d, yyyy h:mm a')}">
      Jan 31, 2026 2:00 PM
    </strong>.
  </p>

  <!-- Summary -->
  <table width="100%" cellpadding="0" cellspacing="0" border="0"
         style="width:100%; border-collapse:collapse; margin-top:12px;">
    <tr>
      <td style="padding:6px 0; font-size:14px;">Service</td>
      <td align="right" style="padding:6px 0; font-size:14px;">
        <strong th:text="${serviceName}">Knotless Braids</strong>
      </td>
    </tr>

    <tr>
      <td style="padding:6px 0; font-size:14px;">Deposit paid</td>
      <td align="right" style="padding:6px 0; font-size:14px;">
        <strong th:text="${'$' + #numbers.formatDecimal(depositAmount, 1, 'COMMA', 2, 'POINT')}">$0.00</strong>
      </td>
    </tr>

    <!-- Show original remaining only if promo applied -->
    <tr th:if="${promoDiscount != null and promoDiscount.signum() != 0}">
      <td style="padding:6px 0; font-size:14px;">Original remaining balance</td>
      <td align="right" style="padding:6px 0; font-size:14px;">
        <span th:text="${'$' + #numbers.formatDecimal(originalRemaining, 1, 'COMMA', 2, 'POINT')}">$0.00</span>
      </td>
    </tr>

    <!-- Promo discount -->
    <tr th:if="${promoDiscount != null and promoDiscount.signum() != 0}">
      <td style="padding:6px 0; font-size:14px;">
        Discount <span th:if="${promoLabel != null}" th:text="'(' + promoLabel + ')'"></span>
      </td>
      <td align="right" style="padding:6px 0; font-size:14px;">
        -<span th:text="${'$' + #numbers.formatDecimal(promoDiscount, 1, 'COMMA', 2, 'POINT')}">$0.00</span>
      </td>
    </tr>

    <!-- Remaining balance label changes depending on promo -->
    <tr>
      <td style="padding:6px 0; font-size:14px;"
          th:text="${(promoDiscount != null and promoDiscount.signum() != 0) ? 'Remaining balance after promo' : 'Remaining balance after deposit'}">
        Remaining balance
      </td>
      <td align="right" style="padding:6px 0; font-size:14px;">
        <strong th:text="${'$' + #numbers.formatDecimal(remainingAmount, 1, 'COMMA', 2, 'POINT')}">$0.00</strong>
      </td>
    </tr>
  </table>

  <!-- Preparation / policy -->
  <div style="margin-top:18px; padding-top:14px; border-top:1px solid #eee;">
    <p style="margin:0 0 10px 0; font-weight:bold;">Before your appointment</p>

    <ul style="margin:0; padding-left:18px;">
      <li style="margin:0 0 8px 0; font-size:14px; line-height:1.4;">
        Please arrive with your hair <strong>washed and blow-dried</strong>.
      </li>
      <li style="margin:0 0 8px 0; font-size:14px; line-height:1.4;">
        There is a <strong>10-minute grace period</strong>.
      </li>
      <li style="margin:0 0 8px 0; font-size:14px; line-height:1.4;">
        <strong>15 minutes late</strong> will result in a <strong>$25 late fee</strong>.
      </li>
      <li style="margin:0 0 8px 0; font-size:14px; line-height:1.4;">
        Arrivals of <strong>20 minutes or more</strong> past scheduled appointment time may result in the appointment being canceled.
      </li>
    </ul>

    <div style="margin-top:18px; padding-top:14px; border-top:1px solid #eee;">
      <p style="margin:0 0 10px 0; font-weight:bold;">Rescheduling & Cancellations</p>

      <ul style="margin:0; padding-left:18px;">
        <li style="margin:0 0 8px 0; font-size:14px; line-height:1.4;">
          Appointments may be rescheduled <strong>at least 48 hours before</strong> the scheduled time to retain deposit.
        </li>

        <li style="margin:0 0 8px 0; font-size:14px; line-height:1.4;">
          Late cancellations result in a <strong>forfeited</strong> deposit. A new deposit will be required to book.
        </li>
      </ul>
    </div>

    <p style="margin:12px 0 0 0; font-size:14px; line-height:1.4;">
      If you have any questions, just reply to this email.
    </p>
  </div>

  <div th:if="${isGuest}" style="margin:0 0 16px 0;">
    <a th:href="${guestCancelUrl}">Cancel appointment</a>
  </div>

  <div th:if="${!isGuest}" style="margin:0 0 16px 0;">
    <a th:href="${memberManageUrl}">Manage appointment</a>
  </div>

</div>
</html>